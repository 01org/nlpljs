<link rel="import" href="./image-item.html">

<polymer-element name="image-card">
  <template>
    <style>
      :host {
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      #container {
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
      }

      #more {
        display: block;
        margin-left: 50%;
      }

      /*
      when an image-item displays inside an image-card, a margin
      appears to be added below the meta paragraph; I couldn't track
      this down, so this work-around removes that margin for
      image-items only in the context of an image-card
      */
      image-item::shadow #meta {
        margin: 0;
      }
    </style>

    <div id="container"></div>
  </template>

  <script src="image-card-frame-chooser.js"></script>

  <script>
    Polymer({
      frameChooser: new FrameChooser(),

      /**
       * Convenience method to append an image search result to the
       * gallery; creates an image-item element for the image object added.
       *
       * @param Object image Representation of image to add; has the
       * format:
       * {
       *   src: <url of image>
       * }
       */
      appendImage: function (image) {
        var self = this;

        var elt = document.createElement('image-item');

        elt.addEventListener('load', function () {
          var frame = self.frameChooser.choose(elt);

          elt.style.width = frame.widthPercent + '%';
          elt.style.height = frame.height + 'px';
          elt.setAttribute('data-frame', frame.name);

          self.$.container.appendChild(elt);
        });

        elt.src = image.src;
      }
    });
  </script>
</polymer-element>
