<link rel="import" href="../../app/content-push/cp-search-google-images.html">

<!--
test for searching Google images
-->
<polymer-element name="cp-search-google-images-test">
  <template>
    <style>
      img {
        max-width: 200px;
      }

      #error {
        color: red;
      }

      [data-show="false"] {
        display: none;
      }
    </style>

    <p>Search Google and display images. Pressing the button
    initiates a search, but only displays 10 of them.
    Press the button again twice to get 10 more results each time
    (to show all of the fetched results). Then pressing it again will initiate
    another search etc.</p>

    <p><button id="fetch" on-click="{{fetchResults}}">Fetch results</button></p>

    <cp-search-google-images id="searchGoogleImages">
    </cp-search-google-images>

    <p id="error" data-show="false">No more results</p>

    <div id="container"></div>
  </template>

  <script>
    Polymer({
      fetchResults: function () {
        var self = this;
        var query = 'angelica';

        this.$.searchGoogleImages.fetch(query)
        .then(
          function (results) {
            if (results.length) {
              for (var i = 0; i < results.length; i++) {
                var img = document.createElement('img');
                img.src = results[i].src;
                self.$.container.insertBefore(img, self.$.container.firstChild);
              }
            } else {
              self.$.error.setAttribute('data-show', 'true');
            }
          }
        );
      }
    });
  </script>
</polymer-element>
